(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{484:function(t,a,e){"use strict";e.r(a);var s=e(53),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"using-core-location-manager"}},[t._v("Using Core Location Manager")]),t._v(" "),e("p",[t._v("In Swift it is possible to get the location of the device using the classes provided within the CoreLocation framework.  To do this you will use a class called CLLocationManager which requires you to implement a few steps to make it work.")]),t._v(" "),e("p",[t._v("You must:")]),t._v(" "),e("ul",[e("li",[t._v("Add a Privacy description to your info.plist")]),t._v(" "),e("li",[t._v("Import the CoreLocation framework into your project")]),t._v(" "),e("li",[t._v("Make your viewController class inherit from the CLLocationManagerDelegate")]),t._v(" "),e("li",[t._v("Create a CLLocationManager object")]),t._v(" "),e("li",[t._v("Set the viewController class as it's delegate, and request authorization to use location services in the app")]),t._v(" "),e("li",[t._v("Start updating the location if the user grants authorization")]),t._v(" "),e("li",[t._v("Get the location and use the values")])]),t._v(" "),e("p",[t._v("Additional steps when using the simulator to test:")]),t._v(" "),e("ul",[e("li",[t._v("While the alert is being presented to the user, select a location to simulate")]),t._v(" "),e("li",[t._v("Then grant access, and get the location.")])]),t._v(" "),e("h2",{attrs:{id:"add-a-privacy-descriptor"}},[t._v("Add a Privacy Descriptor")]),t._v(" "),e("p",[t._v("First you must add some settings (keys with values) to the Info.plist in your project.  These settings will be used to request permission for your application to access the devices location from the user.  The following keys can be used to request permission from the user, and the values you add for these keys will be the message that the user is asked.")]),t._v(" "),e("p",[t._v("Privacy - Location Usage Description")]),t._v(" "),e("p",[t._v("Privacy - Location Always Usage Description")]),t._v(" "),e("p",[t._v("Privacy - Location When In Use Usage Description")]),t._v(" "),e("p",[t._v("Privacy - Location Always and When In Use Usage Description")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),e("p",[t._v('The values are your own custom messages that will be displayed to the user when asking permission. (eg. "Do you let this application access this devices location data?")')])]),t._v(" "),e("p",[t._v("The minimum required key when you are using CoreLocation in your project will be "),e("strong",[t._v("Privacy - Location When In Use Usage Description")]),t._v(".  You can see an example of this here:")]),t._v(" "),e("p",[e("img",{attrs:{src:"/F2020/assets/img/CoreLocation_1.png",alt:"LocationManager"}})]),t._v(" "),e("h2",{attrs:{id:"import-the-corelocation-framework"}},[t._v("Import the CoreLocation Framework")]),t._v(" "),e("p",[t._v("Then at the top of the class that will need to access the geo-location of the device you must add the following import statement:")]),t._v(" "),e("div",{staticClass:"language-swift line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-swift"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// include the CoreLocation framework")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("CoreLocation")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("h2",{attrs:{id:"inherit-from-cllocationmanagerdelegate"}},[t._v("Inherit From CLLocationManagerDelegate")]),t._v(" "),e("p",[t._v("After this you will need to tell your class to inherit from the "),e("strong",[t._v("CLLocationManagerDelegate")]),t._v(".  This lets your class have access to the function that will be used to capture the location.")]),t._v(" "),e("div",{staticClass:"language-swift line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-swift"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Inherit from the LocationManagerDelegate in this class")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ViewController")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("UIViewController")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("CLLocationManagerDelegate")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("h2",{attrs:{id:"create-cllocationmanager-object"}},[t._v("Create CLLocationManager Object")]),t._v(" "),e("p",[t._v("Then you need to create an object of the type CLLocationManager like so:")]),t._v(" "),e("div",{staticClass:"language-swift line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-swift"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Create a CLLocationManager object")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" myLocationManager "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("CLLocationManager")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br")])]),e("h2",{attrs:{id:"set-delegate-and-request-authorization"}},[t._v("Set Delegate and Request Authorization")]),t._v(" "),e("p",[t._v("This object contains the methods needed to request authorization from the user to access the location and request the current location.  You will most often request authorization in the "),e("code",[t._v("viewDidLoad()")]),t._v(" method of your viewController class.  But before you can do this, you must set it's delegate equal to the viewController you are coding in like so:")]),t._v(" "),e("div",{staticClass:"language-swift line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-swift"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Set the locationManager delegate")]),t._v("\nmyLocationManager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("delegate "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("self")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Request authorization from user to access location")]),t._v("\nmyLocationManager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("requestWhenInUseAuthorization")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br")])]),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),e("p",[t._v("You can choose to instead use myLocationManager.requestAlwaysAuthorization() if your application needs to update the location when it is running in the background.  But you will need the correct security authorization value added to the info.plist to use this.")])]),t._v(" "),e("h2",{attrs:{id:"start-to-update-the-location"}},[t._v("Start to Update the Location")]),t._v(" "),e("p",[t._v("To get the current location you you must tell the manager to start updating the location values "),e("strong",[t._v("if and only if")]),t._v(" the user has granted access.  This is best done in one of the delegate protocol functions like so:")]),t._v(" "),e("div",{staticClass:"language-swift line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-swift"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("locationManager")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("_")]),t._v(" manager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("CLLocationManager")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" didChangeAuthorization status"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("CLAuthorizationStatus")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Switch on the state of the authorization to decide what to do.")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("switch")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("CLLocationManager")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("authorizationStatus")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("restricted"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("notDetermined"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("denied "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// If the user has not allowed access stop all updating.")]),t._v("\n        locationManager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("stopUpdatingLocation")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("authorizedWhenInUse"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("authorizedAlways "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// If the user has allowed access start updating the location of the device.")]),t._v("\n        locationManager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("startUpdatingLocation")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    @unknown "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Manage any future states to be exhaustive.")]),t._v("\n        locationLabel"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ERROR: Unable to access Location Manager"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br"),e("span",{staticClass:"line-number"},[t._v("12")]),e("br"),e("span",{staticClass:"line-number"},[t._v("13")]),e("br"),e("span",{staticClass:"line-number"},[t._v("14")]),e("br")])]),e("h2",{attrs:{id:"get-the-location"}},[t._v("Get the Location")]),t._v(" "),e("p",[t._v("Then to get the current location you can access the following values like this:")]),t._v(" "),e("div",{staticClass:"language-swift line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-swift"}},[e("code",[t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Get the current location values if they are set")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" location "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" locationManager"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("location "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" newLatitude "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" location"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("coordinate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("latitude\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" newLongitude "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" location"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("coordinate"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("longitude\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Do something with the values")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br")])]),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),e("p",[t._v("Whenever your application is no longer needing the location to be read you must tell the manager to stop updating the location with this function "),e("code",[t._v("locationManager.stopUpdatingLocation()")]),t._v(".  Depending on your application it might be easiest to call this in the function "),e("code",[t._v("override func viewWillDisappear(_ animated: Bool)")]),t._v(".")])]),t._v(" "),e("h2",{attrs:{id:"testing-in-the-simulator"}},[t._v("Testing in the Simulator")]),t._v(" "),e("p",[t._v("When you launch the application for testing in the simulator you will need to make sure you properly start simulating a location.  While the application is running in the simulator you will need to go back into Xcode and find the option at the bottom.")]),t._v(" "),e("p",[e("img",{attrs:{src:"/F2020/assets/img/CoreLocation_2.png",alt:"LocationManager"}})]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),e("p",[t._v("It is best to do this when the alert has popped up asking the user for permission.")])]),t._v(" "),e("p",[t._v("You will be able to choose a location for the list that pops up.")]),t._v(" "),e("p",[e("img",{attrs:{src:"/F2020/assets/img/CoreLocation_3.png",alt:"LocationManager"}})]),t._v(" "),e("p",[t._v("Then you can accept the request for permission back in the application.")]),t._v(" "),e("p",[e("img",{attrs:{src:"/F2020/assets/img/CoreLocation_4.png",alt:"LocationManager"}})]),t._v(" "),e("p",[t._v("Now when you choose to get the location your application will have permission, and a test location to return the values from.")]),t._v(" "),e("p",[e("img",{attrs:{src:"/F2020/assets/img/CoreLocation_5.png",alt:"LocationManager"}})]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("NOTE")]),t._v(" "),e("p",[t._v("You can also choose from another list of simulated location in the Simulators top menu by selecting Features->Location and selecting your choice of "),e("strong",[t._v("Custom Location")]),t._v(", "),e("strong",[t._v("City Run")]),t._v(", "),e("strong",[t._v("City Bicycle Ride")]),t._v(", "),e("strong",[t._v("Freeway Drive")]),t._v(" or "),e("strong",[t._v("Apple")]),t._v(".  Each one actually simulates a moving device on a predetermined rout that changes over time.")])])])}),[],!1,null,null,null);a.default=n.exports}}]);